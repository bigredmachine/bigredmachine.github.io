<!DOCTYPE html>
<html class="no-js" lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<meta name="generator" content="Hugo 0.80.0" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Ian&#39;s Blog">
    <meta name="author" content="">

    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>Ian&#39;s Blog</title>

   	
    
        <link rel="stylesheet" href="https://bigredmachine.github.io/css/theme/journal.css">
    

    <link rel="stylesheet" href="https://bigredmachine.github.io/css/font-awesome.min.css">

   	
   	<link rel="stylesheet" href="https://bigredmachine.github.io/css/style.css">


    
    <script src="https://bigredmachine.github.io/js/jquery.min-2.1.4.js"></script>
    <script src="https://bigredmachine.github.io/js/bootstrap.min-3.3.5.js"></script>

    
    <link href="https://bigredmachine.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Ian&#39;s Blog" />
</head>
<body lang="en">
    
    <div class="container">
    <div class="row">
        <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="https://bigredmachine.github.io">Ian&#39;s Blog</a>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="https://bigredmachine.github.io">Home</a></li>
					<li><a href="https://bigredmachine.github.io/page/about/">About</a></li>
                    <li><a href="https://bigredmachine.github.io/post/">Blog</a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</div>


    <div class="container">
        
        
            	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<h3><a href="https://bigredmachine.github.io/post/mvp-2020/">Sitecore MVP 2020 - Technology</a></h3>
					<span class="label label-primary">Sat Feb 1, 2020</span> in 
					
						
						<a href="/tags/development">Development</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					 using tags 			 
					
						
						<a href="/tags/mvp">MVP</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					
				</small>
			</div>
		</div>	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<br> 
				<h2 id="sitecore-mvp-2020---technology">Sitecore MVP 2020 - Technology</h2>
<p>I&rsquo;m thankful to receive my 1st Sitecore MVP award in the Technology category for 2020.</p>
<a href="https://mvp.sitecore.com/">

<picture>





	
		
	
	
		
	
	






  <source 
    media="(min-width: 650px)"
    srcset="/post/mvp-2020/images/Sitecore_MVP_logo_2020_hu639937a7b071c4c109d7139ebd34e829_75255_300x0_resize_q100_box.jpg">
	
  <source 
    media="(min-width: 465px)"
    srcset="/post/mvp-2020/images/Sitecore_MVP_logo_2020_hu639937a7b071c4c109d7139ebd34e829_75255_300x0_resize_q100_box.jpg">
	
  <img 
    src="/post/mvp-2020/images/Sitecore_MVP_logo_2020_hu639937a7b071c4c109d7139ebd34e829_75255_300x0_resize_q100_box.jpg" 
    alt="MVP">
</picture>
</a>
<a href="https://mvp.sitecore.com/">

<picture>





	
		
	
	
		
	
	






  <source 
    media="(min-width: 650px)"
    srcset="/post/mvp-2020/images/Sitecore_MVP_Technology_2020_hu546c55212ec4b38f28e19b98886d9195_37580_300x0_resize_q100_box.jpg">
	
  <source 
    media="(min-width: 465px)"
    srcset="/post/mvp-2020/images/Sitecore_MVP_Technology_2020_hu546c55212ec4b38f28e19b98886d9195_37580_300x0_resize_q100_box.jpg">
	
  <img 
    src="/post/mvp-2020/images/Sitecore_MVP_Technology_2020_hu546c55212ec4b38f28e19b98886d9195_37580_300x0_resize_q100_box.jpg" 
    alt="MVP">
</picture>
</a>
<p>I&rsquo;ve been using Sitecore since Sitecore 6 in 2011.</p>
<p>Keep sharing and trying if didn&rsquo;t make it this year, this is my first year I&rsquo;ve been fortunate enough to be selected for the MVP award after several years of applying. <br />
Although it&rsquo;s not enough to just keep on applying, you can&rsquo;t get the award if you don&rsquo;t apply, and you might get some feedback what you need to improve upon.</p>
<p>A lot of my activity with Sitecore might not be publicly visible, and probably explains why I&rsquo;ve not received this award previously.<br />
Digging out dotpeek, finding the root cause of an issue, and possibly supplying a fix on occasion to Sitecore support for review (of course would always prefer to use an official hotfix, but to prove have found the problem &amp; working solution I might get there first). <br />
Or again using dotpeek finding a way to add in support for a feature that isn&rsquo;t currently supported, and sharing the approach with Sitecore to make it easier to extend in future upgrades, or be integrated into the product in the future.<br />
This might not be visible to the community straight away, but hopefully makes the product better in the long run.</p>
<p>Now with the new single Hotfix model per version of Sitecore, these identified issues fixes are more likely to get into the product quicker, as well as making upgrades easier.</p>
<p>I&rsquo;ve been trying to share what I&rsquo;m up to, either blogging, asking/answering questions on Stack Exchange, or presenting when I can.</p>
<p>I&rsquo;ve also been on a train the trainer course on .net core, Docker, K8s and AKS, and delivered this training.</p>
<p>As well as attended a course on improving my public speaking skills.</p>
<p>All of which has helped me practice my public speaking.</p>
<p>Special mentions to <a href="https://scug.co.uk/">Sitecore User Group UK</a> and <a href="http://sitecore.events/">Sitecore Discussion Club</a> for letting me present.<br />
And <a href="https://twitter.com/steviemcgill">Steve McGill</a> and <a href="https://twitter.com/SitecoreMartin">Martin Miles</a> for running them.</p>
<p>As well as to the Sitecore Support &amp; Product teams for collaborating on tickets, and working on getting the fixes/enhancements into the product.</p>
<p>Plus of course the awesome Sitecore community, whether that&rsquo;s Twitter, Sitecore Slack, Blogs, <a href="https://sitecore.stackexchange.com/">Sitecore StackExchange</a>, <a href="https://scug.co.uk/">SCUG Meetups</a> &amp; <a href="http://sitecore.events/">Sitecore Discussion Club</a>, SUGCON, Symposium etc.</p>
<p>As well as the awesome team I work with, but as this is my personal blog I&rsquo;ll leave it at that.</p>
<p>Thanks for reading my blog, more to follow!</p>

			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<hr>
			</div>
		</div>
	
        
            	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<h3><a href="https://bigredmachine.github.io/post/improving-the-solr-content-search-provider/">Improving the Siteore Solr Content Search Provider</a></h3>
					<span class="label label-primary">Tue Nov 26, 2019</span> in 
					
						
						<a href="/tags/development">Development</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					 using tags 			 
					
						
						<a href="/tags/solr">Solr</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					
				</small>
			</div>
		</div>	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<br> 
				<h2 id="improving-the-siteore-solr-content-search-provider">Improving the Siteore Solr Content Search Provider</h2>
<p>Back in February this year I gave a presentation at the <a href="https://www.meetup.com/sug-uk/events/258462625/">London Sitecore User Group</a> &ldquo;Improving the Solr Content Search Provider&rdquo;.</p>
<p>My first talk at a Sitecore User group.</p>
<p>Although I regularly attend the Sitecore discussion club, and have presented there on several occasions.</p>
<h2 id="known-bugs">Known bugs</h2>
<p>At the presentation I included a link to a <a href="https://github.com/bigredmachine/sitecore-solr">github repository</a> with a list of known issues and their public reference numbers.</p>
<p>The list of issues will vary between Sitecore versions, I&rsquo;ve included the list of issues I&rsquo;ve come across between Sitecore 8.2 up to Sitecore 9.0 update 2.</p>
<p>Including:</p>
<ul>
<li>Partially rebuilt index going live - 96016 - IIS recycle - switches Alias although indexing job cancelled/incomplete - fixed in Sitecore 9 initial release</li>
<li>OptimizeOnRebuildEnabled setting not used - was in bug fix 96016 - introduced in Sitecore 9 initial release</li>
<li>Patch for IsSolrAliveAgent to update SolrState and process reinitialisation correctly - 163850.171950</li>
<li>Incorrect data being indexed, if have ContentSearch.Indexing.DisableDatabaseCaches setting set to true - 96740.127177.155383</li>
<li>If IndexAllFields=false the IncludedFields are indexed as string values - New bug in Sitecore 9 - 252532</li>
<li><a href="https://bigredmachine.github.io/post/sitecore-9-index-slow-down/">Index rebuild slow down after Sitecore 9 upgrade</a>.</li>
</ul>
<h2 id="common-patterns-for-distributed-computing">Common Patterns for distributed computing</h2>
<p>The github repostiory also included an example implementation of patterns to address some of the <a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing">fallacies of distributed computing</a>.</p>
<ul>
<li>Circuit Breaker Pattern
<ul>
<li>Don&rsquo;t make every request wait for a timeout exception, use a circuit breaker to fail fast, so can handle load under a degraded scenario</li>
</ul>
</li>
<li>Not swallowing errors
<ul>
<li>We want to know the difference between no results, and an error.</li>
<li>The circuit breaker can&rsquo;t work if we don&rsquo;t know what&rsquo;s an error.</li>
<li>If we don&rsquo;t know the difference then we might cache there are no results, when there are results, but just couldn&rsquo;t retrieve the results.</li>
</ul>
</li>
<li>Shorter timeouts for queries
<ul>
<li>Again, we want queries to fail fast, and for the circuit breaker to kick in. But we can allow longer for indexing operations to take place, especially as there is no retry mechanism on the crawling/indexing side.</li>
</ul>
</li>
</ul>
<h2 id="comparison-of-the-other-options-out-of-the-box">Comparison of the other options out of the box</h2>
<ul>
<li>Sitecore Query</li>
<li>Sitecore Fast Query</li>
<li>Links Database</li>
</ul>
<p>Related blog posts:</p>
<ul>
<li><a href="http://intothecore.cassidy.dk/2016/05/sitecore-decennial-series-2-dont.html">http://intothecore.cassidy.dk/2016/05/sitecore-decennial-series-2-dont.html</a></li>
<li><a href="https://intothecloud.blog/2018/10/21/It-s-time-to-put-fast-query-to-rest/">https://intothecloud.blog/2018/10/21/It-s-time-to-put-fast-query-to-rest/</a></li>
<li><a href="https://bigredmachine.github.io/post/what-is-wrong-with-the-link-database/">What&rsquo;s wrong with the links database</a></li>
</ul>
<p>On reasons not to use each of them, at least on Content Delivery, or when querying over lots of items.</p>
<h2 id="a-list-of-other-alternatives">A list of other alternatives</h2>
<ul>
<li>Lucene
<ul>
<li>Per server copy to maintain</li>
<li>Removed in Sitecore 9.3</li>
</ul>
</li>
<li>Elastic Search
<ul>
<li>No Sitecore Search Provider</li>
</ul>
</li>
<li>Coveo
<ul>
<li>Not a total replacement, would need Coveo + another search provider, so would need considering after chosen initial search provider.</li>
<li>Commercial Cost</li>
<li>Supported Sitecore Search Provider</li>
</ul>
</li>
<li>Algolia
<ul>
<li>Hosted search</li>
<li>No official Sitecore Search Provider, but used in community.</li>
<li>Not a total replacement, would need Algolia + another search provider, so would need considering after chosen initial search provider.</li>
</ul>
</li>
<li>Azure Search
<ul>
<li>At the time there wasn&rsquo;t an offical Sitecore Azure Search provider, there now is.</li>
<li>However it has some limitations such as <a href="https://doc.sitecore.com/developers/92/platform-administration-and-architecture/en/sitecore-azure-search-overview.html">An Azure Search index can only contain up to 1000 fields.</a>
Which could be an issue for the master search index.</li>
<li>In this particular benchmark the crawling rate was slower</li>
<li><a href="https://grantkillian.wordpress.com/2017/03/09/azure-search-compared-to-solr-for-sitecore-paas-chapter-1-ingestion/">https://grantkillian.wordpress.com/2017/03/09/azure-search-compared-to-solr-for-sitecore-paas-chapter-1-ingestion/</a></li>
<li>But the querying rate was similar, although I do question the cost/limits on querying Azure Search if you&rsquo;ve got a high traffic site. And I&rsquo;ve read some people have had to put a Redis cache in front, to not go over the query limit in Azure Search.</li>
<li><a href="https://grantkillian.wordpress.com/2017/03/20/azure-search-compared-to-solr-for-sitecore-paas-chapter-2-querying/">https://grantkillian.wordpress.com/2017/03/20/azure-search-compared-to-solr-for-sitecore-paas-chapter-2-querying/</a></li>
</ul>
</li>
</ul>
<h2 id="examples-of-customisations">Examples of Customisations</h2>
<p>Changing MyItems &amp; Unlock all to use Solr, rather than a Sitecore Query.</p>
<p>I told you Sitecore.Query was slow, and Memory Intensive.</p>
<h2 id="since-giving-this-presentation">Since giving this presentation</h2>
<p>Infact since giving this talk, one of the issues that got me to customise the Sitecore Solr Search provider in the first place reared its head again. Sitecore not being able to startup when Solr is down.</p>
<h2 id="i-thought-wed-fixed-that-already-why-cant-sitecore-startup-when-solr-is-down-anymore">I thought we&rsquo;d fixed that already, why can&rsquo;t Sitecore startup when Solr is down anymore?</h2>
<p>Well the number of Sitecore indexes had grown over time.</p>
<p>On startup each index was doing it&rsquo;s own check to see if Solr was available, and waiting for a timeout/exception. This was happening in series. Depending on the type of error you get, if it&rsquo;s a timeout, this can result in Sitecore taking longer to startup than IIS allows. Causing IIS to recycle the application and try again, in an infinite loop. Oh dear!</p>
<p>So I&rsquo;ve added to the github repository a new issue <a href="https://github.com/bigredmachine/sitecore-solr">314454 - Sitecore doesn&rsquo;t startup when Solr Down.</a></p>
<h2 id="simulating-solr-being-downlatency">Simulating Solr being down/latency</h2>
<p>You can simulate on your local PC latency to Solr using Fiddler.
If you change your solr connection string to</p>
<p><code>http://localhost.:8983/solr;solrCloud=true</code></p>
<p>Notice the &ldquo;.&rdquo;, will ensure the traffic goes through Fiddler</p>
<p>Change your Sitecore IIS Application Pool to run as your local user, as Fiddler automatically picks up traffic running as your local user. (Or you can change the proxy settings)</p>
<p>Then run Fiddler.</p>
<p>Under &ldquo;AutoResponder&rdquo; tab, you can add a Rule for requests matching</p>
<p><code>http://localhost.8983/solr/.....</code></p>
<p>The URL you set could be specific to a particular index, or request, depending on what you want to test.</p>
<p>Then on the response for that URL you can set</p>
<p><code>*delay:10000</code></p>
<p>with how many milliseconds you want to delay the request with.</p>
<p>Using this technique you can simulate a network timeout,
rather than a quicker port not listening/service not running error.</p>
<p>And from this can replicate the issue of Sitecore note being able to start up, if you have enough indexes which all timeout on startup.</p>
<h2 id="whats-in-314454---sitecore-doesnt-startup-when-solr-down">What&rsquo;s in 314454 - Sitecore doesn&rsquo;t startup when Solr Down</h2>
<p>Sitecore doesn&rsquo;t issue patches anymore, so instead you get a hotfix, which include all of the issue fixes for that version of Sitecore you are on.</p>
<p>For Sitecore 9.0 update 2, this was included in hotfix 323662-1.</p>
<ol>
<li>If you have enough indexes, the timeout on initialisation from each index run in sequence can result in Sitecore not being starting up in the allowed time.</li>
<li>Retry logic for SolrCloud aliases.</li>
<li>Retry logic for initialising Indexes</li>
<li>Exception handling in IsOnline index check.</li>
<li>Initialisation of indexes to not be interupted if Solr is unavailable, to initialise what can and retry later.</li>
</ol>
<p>And included changes to dlls</p>
<ul>
<li>Sitecore.ContentSearch.Client.dll</li>
<li>Sitecore.ContentSearch.Data.dll</li>
<li>Sitecore.ContentSearch.dll</li>
<li>Sitecore.ContentSearch.Linq.dll</li>
<li>Sitecore.ContentSearch.Linq.Lucene.dll</li>
<li>Sitecore.ContentSearch.LuceneProvider.dll</li>
<li>Sitecore.ContentSearch.SolrNetExtension.dll</li>
<li>Sitecore.ContentSearch.SolrProvider.dll</li>
</ul>
<p>There were so many changes it felt like a mini Sitecore Upgrade.
And the contract changed, had to rewrite our customisations for them to continue to work.</p>
<p>This hotfix fixes the slow startup issue, but only checking once if Solr is available, rather than per index.
So make Sitecore much faster to startup when Solr is down.</p>
<p>There was also some work to make the initialising of the indexes to work in parallel, to further speed up the time for initialisation.</p>
<h2 id="customisations-and-upgrades">Customisations and Upgrades</h2>
<p>Each time we upgrade, we have to see if our customisations are still possible.
Often the extension points/hooks we have used have gone, and we have to find new ones.</p>
<p>Even on this update to the hotfix which address 314454, we had to do a lot of rework.</p>
<p>Hopefully in a future version of the product the extensions points we require will be included in the product, and we won&rsquo;t have to get out dotpeek to find a place to override, and use reflection/so many custom classes and overrides to change the behaviour to what we need.</p>
<h2 id="update-the-repository-examples">Update the repository examples</h2>
<p>As the hotfix isn&rsquo;t publicly available in the nuget feeds, and the contract has changed.</p>
<p>I can&rsquo;t update the example code to reference the hotfix, and for it to still compile.</p>
<p>If anyone is interested to see the examples updated to use the hotfix, reach out to me on twitter, and I can see about creating a feature branch.</p>
<p>Otherwise, I&rsquo;m going to wait for a version of Sitecore which includes these fixes/contract changes, which is available in the nuget feed so I can update the examples and still have it compiling.</p>

			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<hr>
			</div>
		</div>
	
        
            	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<h3><a href="https://bigredmachine.github.io/post/federated-authentication-single-sign-out/">Federated Authentication Single Sign Out</a></h3>
					<span class="label label-primary">Sun Nov 24, 2019</span> in 
					
						
						<a href="/tags/development">Development</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					 using tags 			 
					
						
						<a href="/tags/federated-authentication">Federated Authentication</a>
					
						 , 
						<a href="/tags/sitecore">Sitecore</a>
					
						 , 
						<a href="/tags/azuread">AzureAD</a>
					
				</small>
			</div>
		</div>	
		<div class="row">
			<div class="col-md-offset-1 col-md-10">
				<br> 
				<h2 id="federated-authentication-single-sign-out">Federated Authentication Single Sign Out</h2>
<p>By default when you sign out of Sitecore, you don&rsquo;t get signed out of your Federated Authentication Provider (Tested against Sitecore 9.0). So if after you sign out, you try to sign in again, your Federated Authentication Provider still recognises you and doesn&rsquo;t challenge you to sign back in again, and lets you into the system.</p>
<p>So have you really signed out, if you haven&rsquo;t signed out of the Federated Authentication provider as well? IMHO - no.</p>
<h2 id="whats-the-behaviour-of-other-services-using-federated-authentication">What&rsquo;s the behaviour of other services using Federated Authentication?</h2>
<p>If you log out of Microsoft Office 365, it also logs you out of Azure AD.</p>
<p>If you log out of Azure Portal, it also logs you out of Azure AD.</p>
<p>Also note, on the Azure AD sign out page, it also signs you out of Office 365, if you are signing out from another system. (That&rsquo;s going even further, to an even more true single sign out where sign out of every system at once, but the sign out page has to know about all of the systems to sign you out of, beyond the scope of this post)</p>
<p>So can see it&rsquo;s pretty standard behaviour when you sign out of a system, to also sign you out of the Federated Authentication provider as well.</p>
<h2 id="so-how-do-you-configure-sitecore-to-sign-out-of-a-federated-authentication-provider-as-well-as-sitecore">So how do you configure Sitecore to sign out of a Federated Authentication provider as well as Sitecore? </h2>
<p>Pipelines/Processor + Reflector = Win!</p>
<p> </p>

<picture>










  <source 
    media="(min-width: 650px)"
    srcset="/post/federated-authentication-single-sign-out/images/pipelines_hu736a386aecced7e0b41b74d134483cb0_84525_650x0_resize_q100_box.jpg">
	
  <source 
    media="(min-width: 465px)"
    srcset="/post/federated-authentication-single-sign-out/images/pipelines_hu736a386aecced7e0b41b74d134483cb0_84525_465x0_resize_q100_box.jpg">
	
  <img 
    src="/post/federated-authentication-single-sign-out/images/pipelines_hu736a386aecced7e0b41b74d134483cb0_84525_300x0_resize_q100_box.jpg" 
    alt="Pipelines Everywhere">
</picture>
<p> </p>
<h3 id="for-the-launchpad-using-speak">For the LaunchPad using Speak</h3>
<p>Starting with the Sitecore Launch pad.</p>
<p>The &ldquo;Log out&rdquo; button has some JS that fires &ldquo;-/speak/v1/business/AccountInformation.js&rdquo;.
Which does an AJAX POST request to &ldquo;/sitecore/shell/api/sitecore/Authentication/Logout?sc_database=master&rdquo;.
It then tries to parse the JSON result, and read the &ldquo;Redirect&rdquo; value.
And then redirects the user client side to the specified url.</p>
<p>Serverside this &ldquo;AuthenticationController&rdquo; can be found in &ldquo;Sitecore.Speak.Client.dll&rdquo; &ldquo;Sitecore.Controllers.AuthenticationController&rdquo; &ldquo;Logout&rdquo; HttpPost method.</p>
<p>This in turn calls &ldquo;Sitecore.Shell.Security().Logout&rdquo; passing in an &ldquo;Action<UrlString>&rdquo;, to capture the RedirectUrl for the JSON result.</p>
<p>&ldquo;Sitecore.Shell.Security().Logout&rdquo; calls a pipeline &ldquo;speak.logout&rdquo;.
This pipeline takes an argument of type &ldquo;LogoutArgs&rdquo;.
&ldquo;LogoutArgs&rdquo; has a property &ldquo;RedirectUrl&rdquo; of type &ldquo;UrlString&rdquo;.</p>
<p>&ldquo;RedirectUrl&rdquo; is initialised before the pipeline &ldquo;speak.logout&rdquo; is called with &ldquo;Context.Site.LoginPage&rdquo;.
And after the pipleline is called, the &ldquo;RedirectUrl&rdquo; value is used to send the client to the specified page.</p>
<h3 id="for-the-content-editor">For the Content Editor</h3>
<p>The content editor on the other hand the &ldquo;Log out&rdquo; button calls onclick &ldquo;scForm.postEvent(this, event, &lsquo;system.logout&rsquo;)&rdquo;.</p>
<p>This triggers the processor &ldquo;logout&rdquo;.
This also takes the same argument of type &ldquo;LogoutArgs&rdquo;, as the &ldquo;speak.logout&rdquo; pipeline.</p>
<p>If the &ldquo;LogoutArgs&rdquo; &ldquo;RedirectUrl&rdquo; property has not been set, it triggers a server side redirect to the &ldquo;Client.Site.LoginPage&rdquo;.
See &ldquo;Sitecore.Kernel.dll&rdquo;, &ldquo;Sitecore.Pipelines.Logout.GotoLogin.Process&rdquo; method.</p>
<h3 id="pipeline">Pipeline</h3>
<p>So to override the behaviour of logout going to the Sitecore login page.
Adding a pipeline to &ldquo;Speak.Logout&rdquo; to set the &ldquo;RedirectUrl&rdquo;.</p>
<p>And adding a processor to &ldquo;logout&rdquo; before the processor &ldquo;Sitecore.Pipelines.Logout.GotoLogin, Sitecore.Kernel&rdquo;, to set the &ldquo;RedirectUrl&rdquo;.</p>
<p>We can control where users are redirected to on logout.</p>
<h3 id="federated-authentication-provider-settings-not-used">Federated Authentication Provider settings not used</h3>
<p>Interestingly when configuring a Federated Authentication provider, you specify on the &ldquo;OpenIdConnectAuthenticationOptions&rdquo; class the &ldquo;PostLogoutRedirectUri&rdquo;, but this isn&rsquo;t used.
Still we can reuse this configuration setting in our pipeline.</p>
<h3 id="example-settings-to-change-redirecturl-to">Example settings to change RedirectUrl to</h3>
<p>If you are using Azure AD, you can set the &ldquo;RedirectUrl&rdquo; to something like &ldquo;<a href="https://login.microsoft.com/common/oauth2/logout?post_logout_redirect_uri=https%3A%2F%2fsitecore.local%2Fsitecore%2Flogin%22">https://login.microsoft.com/common/oauth2/logout?post_logout_redirect_uri=https%3A%2F%2fsitecore.local%2Fsitecore%2Flogin&quot;</a></p>
<p>So it will log you out of Azure AD, then redirect you back to &ldquo;<a href="https://sitecore.local/sitecore/login%22">https://sitecore.local/sitecore/login&quot;</a></p>
<p>Obviously change the &ldquo;post_logout_redirect_uri&rdquo; parameter to match your environment.</p>
<h2 id="summary">Summary</h2>
<p>With a few extra pipelines, and with the help of reflector, can achieve single sign out with Sitecore.</p>
<h2 id="additional-notes">Additional Notes</h2>
<p>I&rsquo;ve only tried this with Sitecore 9.0, and not with the new Sitecore Identity Server.</p>

			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<hr>
			</div>
		</div>
	
        
	</div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="text-center">
                    
<ul class="pagination">
  <li class="page-item">
    <a href="/" class="page-link" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/" class="page-link" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/">1</a>
  </li>
  <li class="page-item active">
    <a class="page-link" href="/page/2/">2</a>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/3/">3</a>
  </li>
  <li class="page-item disabled">
    <span aria-hidden="true">&nbsp;&hellip;&nbsp;</span>
  </li>
  <li class="page-item">
    <a class="page-link" href="/page/6/">6</a>
  </li>
  <li class="page-item">
    <a href="/page/3/" class="page-link" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
  </li>
  <li class="page-item">
    <a href="/page/6/" class="page-link" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
  </li>
</ul>


                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <hr>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row col-md-12">
            <footer>
                <div class="pull-left">
                    <p>
                        &copy; 2015-2021 Ian Jones.
                    </p>
                </div>

                
                <div class="pull-right">
                    
                    
                    
                        <a href="https://twitter.com/darkhorseian" target="_blank">
                        <i class="fa fa-twitter-square fa-2x"></i></a>
                    
                    
                    
                    
                    
                        <a href="https://bigredmachine.github.io/index.xml" target="_blank">
                        <i class="fa fa-rss-square fa-2x"></i></a>
                    
                </div>
            </footer>
        </div>
    </div>

    
    </body>
</html>

